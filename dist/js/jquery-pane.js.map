{"version":3,"file":"jquery-pane.js","sources":["../../src/js/Pane.js"],"sourcesContent":["/*\r\n * This file is part of jQuery Pane.\r\n *\r\n * @license   https://opensource.org/licenses/MIT MIT License\r\n * @copyright 2018\r\n * @author Cassie ROUSSEAU <https://github.com/K6-front>\r\n * @author Ronan GIRON <https://github.com/ElGigi>\r\n * @author Yohann LORANT <https://github.com/ylorant>\r\n *\r\n * For the full copyright and license information, please view the LICENSE\r\n * file that was distributed with this source code, to the root.\r\n */\r\n\r\nimport $ from 'jquery'\r\n\r\nconst PaneManager = (($) => {\r\n  // Check jQuery requirements\r\n  if (typeof $ === 'undefined') {\r\n    throw new TypeError('jQuery Pane requires jQuery. jQuery must be included before.')\r\n  }\r\n\r\n  /**\r\n   * Get Internet Explorer version.\r\n   *\r\n   * @return {number}\r\n   */\r\n  function GetIEVersion() {\r\n    let sAgent = window.navigator.userAgent\r\n    let Idx = sAgent.indexOf(\"MSIE\")\r\n\r\n    // If IE, return version number.\r\n    if (Idx > 0) {\r\n      return parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)))\r\n    }\r\n    // If IE 11 then look for Updated user agent string.\r\n    else if (!!navigator.userAgent.match(/Trident\\/7\\./)) {\r\n      return 11\r\n    } else {\r\n      return 0 //It is not IE\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Defaults\r\n   */\r\n\r\n  const Default = {\r\n    debug: false,\r\n    container: 'body',\r\n    loader: '',\r\n    transitionInTime: 50,\r\n    transitionOutTime: 400,\r\n    ajax: {},\r\n  }\r\n\r\n  /**\r\n   * Events\r\n   */\r\n\r\n  const Event = {\r\n    // Pane\r\n    SHOW: 'show.pane',\r\n    SHOWN: 'shown.pane',\r\n    HIDE: 'hide.pane',\r\n    HIDDEN: 'hidden.pane',\r\n    // Pane content\r\n    LOADING: 'loading.content.pane',\r\n    LOADED: 'loaded.content.pane',\r\n    LOADING_ERROR: 'error.content.pane',\r\n    PRINTED: 'printed.content.pane',\r\n    SUBMIT: 'submit.content.pane',\r\n    // Selectors\r\n    CLICK_DISMISS: 'click.dismiss.pane',\r\n    CLICK_DATA_API: 'click.pane',\r\n    SUBMIT_DATA_API: 'submit.pane',\r\n  }\r\n\r\n  /**\r\n   * SELECTORS\r\n   */\r\n\r\n  const Selector = {\r\n    WRAPPER: '.pane-wrapper:first',\r\n    LOADER: '.pane-loader',\r\n    PANE: '.pane:not(.pane-static)',\r\n    FORM: 'form:not([target])',\r\n    SUBMIT: 'form:not([target]) :submit[name]',\r\n    DATA_TOGGLE: '[data-toggle=\"pane\"]',\r\n    DATA_DISMISS: '[data-dismiss=\"pane\"]',\r\n  }\r\n\r\n  /**\r\n   * PaneManager\r\n   */\r\n  class PaneManager {\r\n    constructor(config) {\r\n      this._config = this._getConfig(config)\r\n      this._wrapper = null\r\n      this._events()\r\n\r\n      // Debug\r\n      if (this.config('debug')) {\r\n        console.debug('PaneManager initialized')\r\n      }\r\n    }\r\n\r\n    // Getters\r\n\r\n    get wrapper() {\r\n      if (!this._wrapper) {\r\n        this._wrapper = $(Selector.WRAPPER)\r\n\r\n        if (this._wrapper.length === 0) {\r\n          this._wrapper = $('<div class=\"pane-wrapper\"></div>')\r\n          $(this._config.container).append(this._wrapper)\r\n        }\r\n\r\n        // Internet explorer\r\n        if (!this._wrapper.hasClass('pane-ie') && GetIEVersion() > 0) {\r\n          this._wrapper.addClass('pane-ie')\r\n        }\r\n      }\r\n\r\n      return this._wrapper\r\n    }\r\n\r\n    // Public\r\n\r\n    refresh() {\r\n      this._wrapper.toggleClass('is-open', $(Selector.PANE, this._wrapper).length > 0)\r\n    }\r\n\r\n    config(key) {\r\n      if (!typeof this._config[key]) {\r\n        throw new TypeError('Undefined option name \"' + key + '\"')\r\n      }\r\n\r\n      return this._config[key]\r\n    }\r\n\r\n    new(paneClass) {\r\n      let pane = new Pane(this)\r\n      pane.open(paneClass || '')\r\n\r\n      return pane\r\n    }\r\n\r\n    // Private\r\n\r\n    _events() {\r\n      let manager = this\r\n\r\n      $(document)\r\n        .off(Event.CLICK_DATA_API, Selector.DATA_TOGGLE)\r\n        .on(Event.CLICK_DATA_API,\r\n            Selector.DATA_TOGGLE,\r\n            function (event) {\r\n              event.preventDefault()\r\n\r\n              // Debug\r\n              if (manager.config('debug')) {\r\n                console.debug('Selector', Selector.DATA_TOGGLE, 'has been clicked')\r\n              }\r\n\r\n              manager._pane(this)\r\n            })\r\n    }\r\n\r\n    _pane(relatedTarget) {\r\n      let pane = null,\r\n        href = $(relatedTarget).data('href') || $(relatedTarget).attr('href'),\r\n        target = $(relatedTarget).data('paneTarget') || ''\r\n\r\n      if (!href) {\r\n        console.error('Pane has no href to load content')\r\n        return\r\n      }\r\n\r\n      // Target self?\r\n      if (target === 'self') {\r\n        pane = $(relatedTarget).parents(Selector.PANE).data('pane')\r\n      }\r\n\r\n      // Need to create pane?\r\n      if (!pane) {\r\n        pane = this.new($(relatedTarget).data('paneClass') || '')\r\n      }\r\n      pane.load(href)\r\n\r\n      return pane\r\n    }\r\n\r\n    _getConfig(config) {\r\n      config = {\r\n        ...Default,\r\n        ...config\r\n      }\r\n\r\n      return config\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Pane\r\n   */\r\n  class Pane {\r\n    constructor(paneManager) {\r\n      this._manager = paneManager\r\n      this._jqXHR = null\r\n      this._isTransitioning = false\r\n      this._element = null\r\n      this._href = null\r\n\r\n      this._element = $('<div role=\"complementary\" class=\"pane\"></div>')\r\n      this._element.data('pane', this)\r\n      this._events()\r\n    }\r\n\r\n    // Public\r\n\r\n    open(className) {\r\n      if (this._isTransitioning) {\r\n        return\r\n      }\r\n\r\n      let pane = this\r\n\r\n      // Size?\r\n      if (typeof className === 'string') {\r\n        pane._element.addClass(className)\r\n      }\r\n\r\n      this._isTransitioning = true\r\n      this._manager.wrapper.prepend(this._element)\r\n      this._manager.refresh()\r\n\r\n      // Event trigger\r\n      pane._element.trigger(Event.SHOW)\r\n      if (pane._manager.config('debug')) {\r\n        console.debug('Triggered event:', Event.SHOW)\r\n      }\r\n\r\n      // Animation\r\n      setTimeout(\r\n        function () {\r\n          pane._element.addClass('is-visible')\r\n\r\n          // Event trigger\r\n          pane._element.trigger(Event.SHOWN)\r\n          if (pane._manager.config('debug')) {\r\n            console.debug('Triggered event:', Event.SHOWN)\r\n          }\r\n\r\n          pane._isTransitioning = false\r\n        },\r\n        50\r\n      )\r\n    }\r\n\r\n    reload(fragments) {\r\n      this.load(this._href, fragments)\r\n    }\r\n\r\n    load(href, fragments) {\r\n      if (typeof href !== 'string') {\r\n        throw new TypeError('Pane::load() method need href in first argument')\r\n      }\r\n\r\n      this._ajax({url: href}, fragments)\r\n      this._href = href\r\n    }\r\n\r\n    close() {\r\n      if (this._isTransitioning) {\r\n        return\r\n      }\r\n\r\n      let pane = this,\r\n        manager = this._manager\r\n\r\n      // Event trigger\r\n      let eventClose = $.Event(Event.HIDE, {pane: pane._element})\r\n      pane._element.trigger(eventClose)\r\n      if (pane._manager.config('debug')) {\r\n        console.debug('Triggered event:', Event.HIDE)\r\n      }\r\n\r\n      if (!eventClose.isPropagationStopped()) {\r\n        // Animation\r\n        this._isTransitioning = true\r\n        pane._element.removeClass('is-visible')\r\n\r\n        // After animation\r\n        setTimeout(\r\n          function () {\r\n            pane._element.remove()\r\n            manager.refresh()\r\n\r\n            // Event trigger\r\n            pane._element.trigger(Event.HIDDEN)\r\n            if (pane._manager.config('debug')) {\r\n              console.debug('Triggered event:', Event.HIDDEN)\r\n            }\r\n\r\n            pane._isTransitioning = false\r\n          },\r\n          400\r\n        )\r\n      }\r\n    }\r\n\r\n    // Private\r\n\r\n    _events() {\r\n      let pane = this\r\n\r\n      this._element\r\n          // Dismiss\r\n          .off(Event.CLICK_DISMISS, Selector.DATA_DISMISS)\r\n          .on(Event.CLICK_DISMISS,\r\n              Selector.DATA_DISMISS,\r\n              function (event) {\r\n                event.preventDefault()\r\n\r\n                pane.close()\r\n              })\r\n          // Submit buttons\r\n          .off(Event.CLICK_DATA_API, Selector.SUBMIT)\r\n          .on(Event.CLICK_DATA_API,\r\n              Selector.SUBMIT,\r\n              function () {\r\n                let $form = $(this).parents('form')\r\n\r\n                $form.data('submitButton',\r\n                           {\r\n                             'name': $(this).attr('name'),\r\n                             'value': $(this).val(),\r\n                             'novalidate': ($(this).attr('formnovalidate') !== undefined)\r\n                           })\r\n              })\r\n          // Submit form\r\n          .off(Event.SUBMIT_DATA_API, Selector.FORM)\r\n          .on(Event.SUBMIT_DATA_API,\r\n              Selector.FORM,\r\n              function (event) {\r\n                event.preventDefault()\r\n\r\n                let $form = $(this)\r\n\r\n                // Submit button\r\n                let submitButton = null\r\n                if ($.isPlainObject($form.data('submitButton'))) {\r\n                  submitButton = $form.data('submitButton')\r\n                }\r\n\r\n                if ((submitButton && submitButton.novalidate) ||\r\n                  typeof $form.get(0).checkValidity !== 'function' ||\r\n                  $form.get(0).checkValidity()) {\r\n                  // Get data of form\r\n                  let formData = pane._serializeForm($form)\r\n\r\n                  // Add button to form data\r\n                  if (submitButton) {\r\n                    formData.append(submitButton.name, submitButton.value)\r\n                  }\r\n\r\n                  // Form submission\r\n                  pane._ajax({\r\n                               url: $(this).attr('action') || pane._href,\r\n                               method: $(this).attr('method') || 'get',\r\n                               processData: false,\r\n                               contentType: false,\r\n                               data: formData,\r\n                               dataType: 'json'\r\n                             })\r\n\r\n                  // Remove submit button reference\r\n                  $form.removeData('submitButton')\r\n                }\r\n              })\r\n    }\r\n\r\n    _serializeForm(form) {\r\n      var formData = new FormData(),\r\n        formParams = form.serializeArray()\r\n\r\n      $.each(form.find('input[type=\"file\"]'), function (i, tag) {\r\n        $.each($(tag)[0].files, function (i, file) {\r\n          formData.append(tag.name, file)\r\n        })\r\n      })\r\n\r\n      $.each(formParams, function (i, val) {\r\n        formData.append(val.name, val.value)\r\n      })\r\n\r\n      return formData\r\n    }\r\n\r\n    _loader(toggle) {\r\n      toggle = typeof toggle === 'boolean' ? toggle : true\r\n\r\n      if (toggle) {\r\n        let $loader = $(Selector.LOADER, this._element)\r\n\r\n        if ($loader.length === 0) {\r\n          $loader = $('<div class=\"pane-loader\"></div>')\r\n          $loader.append(this._manager.config('loader'))\r\n          $(this._element).prepend($loader)\r\n        }\r\n      } else {\r\n        $(Selector.LOADER, this._element).remove()\r\n      }\r\n    }\r\n\r\n    _ajax(options, fragments) {\r\n      if (this._jqXHR) {\r\n        return\r\n      }\r\n\r\n      let pane = this\r\n\r\n      // Event trigger\r\n      pane._element.trigger(Event.LOADING)\r\n      if (pane._manager.config('debug')) {\r\n        console.debug('Triggered event:', Event.LOADING)\r\n      }\r\n      pane._loader(true)\r\n\r\n      // Ajax options\r\n      options = {\r\n        method: 'get',\r\n        ...this._manager.config('ajax'),\r\n        ...options,\r\n        success: function (data, textStatus, jqXHR) {\r\n          pane._jqXHR = null\r\n          pane._loader(false)\r\n\r\n          let eventLoaded = $.Event(Event.LOADED,\r\n                                    {\r\n                                      pane: pane._element,\r\n                                      paneAjax: {\r\n                                        data: data,\r\n                                        textStatus: textStatus,\r\n                                        jqXHR: jqXHR,\r\n                                        fragments: fragments || null,\r\n                                      }\r\n                                    })\r\n\r\n          // Event trigger\r\n          pane._element.trigger(eventLoaded)\r\n          if (pane._manager.config('debug')) {\r\n            console.debug('Triggered event:', Event.LOADED)\r\n          }\r\n\r\n          if (!eventLoaded.isPropagationStopped()) {\r\n            if (fragments) {\r\n              $(fragments, pane._element).first().html($(jqXHR.responseText).find(fragments).html())\r\n            } else {\r\n              pane._element.html(jqXHR.responseText)\r\n            }\r\n\r\n            pane._element.trigger(Event.PRINTED, pane._element)\r\n            if (pane._manager.config('debug')) {\r\n              console.debug('Triggered event:', Event.PRINTED)\r\n            }\r\n          }\r\n        },\r\n        error: function (jqXHR, textStatus, errorThrown) {\r\n          pane._jqXHR = null\r\n          pane._loader(false)\r\n\r\n          let eventLoadingError = $.Event(Event.LOADING_ERROR,\r\n                                          {\r\n                                            pane: pane._element,\r\n                                            paneAjax: {\r\n                                              textStatus: textStatus,\r\n                                              jqXHR: jqXHR,\r\n                                              errorThrown: errorThrown,\r\n                                            }\r\n                                          })\r\n\r\n          // Event trigger\r\n          pane._element.trigger(eventLoadingError)\r\n          if (pane._manager.config('debug')) {\r\n            console.debug('Triggered event:', Event.LOADING_ERROR)\r\n          }\r\n\r\n          if (!eventLoadingError.isPropagationStopped()) {\r\n            pane.close()\r\n          }\r\n        }\r\n      }\r\n\r\n      // Ajax\r\n      this._jqXHR = $.ajax(options)\r\n    }\r\n\r\n    static _jQueryInterface(action, arg1, arg2) {\r\n      return this.each(function () {\r\n        if (!(typeof $(this).data('pane') === 'object' && $(this).data('pane') instanceof Pane)) {\r\n          throw new Error('Not a pane')\r\n        }\r\n\r\n        if (typeof action === 'string') {\r\n          let pane = $(this).data('pane')\r\n\r\n          switch (action) {\r\n            case 'close':\r\n            case 'load':\r\n            case 'reload':\r\n              pane[action](arg1, arg2)\r\n              break\r\n            default:\r\n              throw new TypeError(`No method named \"${action}\"`)\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  // jQuery\r\n  $.fn['pane'] = Pane._jQueryInterface\r\n  $.fn['pane'].noConflict = function () {\r\n    return Pane._jQueryInterface\r\n  }\r\n\r\n  return function (config) {\r\n    return new PaneManager(config)\r\n  }\r\n})($)\r\n\r\nexport default PaneManager"],"names":["PaneManager","$","TypeError","GetIEVersion","sAgent","window","navigator","userAgent","Idx","indexOf","parseInt","substring","match","Default","debug","container","loader","transitionInTime","transitionOutTime","ajax","Event","SHOW","SHOWN","HIDE","HIDDEN","LOADING","LOADED","LOADING_ERROR","PRINTED","SUBMIT","CLICK_DISMISS","CLICK_DATA_API","SUBMIT_DATA_API","Selector","WRAPPER","LOADER","PANE","FORM","DATA_TOGGLE","DATA_DISMISS","config","_config","_getConfig","_wrapper","_events","console","toggleClass","length","key","paneClass","pane","Pane","open","manager","document","off","on","event","preventDefault","_pane","relatedTarget","href","data","attr","target","error","parents","new","load","append","hasClass","addClass","paneManager","_manager","_jqXHR","_isTransitioning","_element","_href","className","wrapper","prepend","refresh","trigger","setTimeout","fragments","_ajax","url","eventClose","isPropagationStopped","removeClass","remove","close","$form","val","undefined","submitButton","isPlainObject","novalidate","get","checkValidity","formData","_serializeForm","name","value","method","processData","contentType","dataType","removeData","form","FormData","formParams","serializeArray","each","find","i","tag","files","file","toggle","$loader","options","_loader","success","textStatus","jqXHR","eventLoaded","paneAjax","first","html","responseText","errorThrown","eventLoadingError","action","arg1","arg2","Error","fn","_jQueryInterface","noConflict"],"mappings":"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"}