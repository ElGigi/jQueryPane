{"version":3,"file":"jquery-pane.js","sources":["../../src/js/Pane.js"],"sourcesContent":["/*\r\n * This file is part of jQuery Pane.\r\n *\r\n * @license   https://opensource.org/licenses/MIT MIT License\r\n * @copyright 2018\r\n * @author Cassie ROUSSEAU <https://github.com/K6-front>\r\n * @author Ronan GIRON <https://github.com/ElGigi>\r\n *\r\n * For the full copyright and license information, please view the LICENSE\r\n * file that was distributed with this source code, to the root.\r\n */\r\n\r\nimport $ from 'jquery'\r\n\r\nconst PaneManager = (($) => {\r\n  // Check jQuery requirements\r\n  if (typeof $ === 'undefined') {\r\n    throw new TypeError('jQuery Pane requires jQuery. jQuery must be included before.')\r\n  }\r\n\r\n  /**\r\n   * Defaults\r\n   */\r\n\r\n  const Default = {\r\n    debug: false,\r\n    container: 'body',\r\n    loader: '',\r\n    transitionInTime: 50,\r\n    transitionOutTime: 400,\r\n    ajax: {},\r\n  }\r\n\r\n  /**\r\n   * Events\r\n   */\r\n\r\n  const Event = {\r\n    // Pane\r\n    SHOW: 'show.pane',\r\n    SHOWN: 'shown.pane',\r\n    HIDE: 'hide.pane',\r\n    HIDDEN: 'hidden.pane',\r\n    // Pane content\r\n    LOADING: 'loading.content.pane',\r\n    LOADED: 'loaded.content.pane',\r\n    LOADING_ERROR: 'error.content.pane',\r\n    PRINTED: 'printed.content.pane',\r\n    SUBMIT: 'submit.content.pane',\r\n    // Selectors\r\n    CLICK_DISMISS: 'click.dismiss.pane',\r\n    CLICK_DATA_API: 'click.pane',\r\n    SUBMIT_DATA_API: 'submit.pane',\r\n  }\r\n\r\n  /**\r\n   * SELECTORS\r\n   */\r\n\r\n  const Selector = {\r\n    WRAPPER: '.pane-wrapper:first',\r\n    LOADER: '.pane-loader',\r\n    PANE: '.pane',\r\n    FORM: 'form:not([target])',\r\n    SUBMIT: 'form:not([target]) :submit[name]',\r\n    DATA_TOGGLE: '[data-toggle=\"pane\"]',\r\n    DATA_DISMISS: '[data-dismiss=\"pane\"]',\r\n  }\r\n\r\n  /**\r\n   * PaneManager\r\n   */\r\n  class PaneManager {\r\n    constructor(config) {\r\n      this._config = this._getConfig(config)\r\n      this._wrapper = null\r\n      this._events()\r\n\r\n      // Debug\r\n      if (this.config('debug')) {\r\n        console.debug('PaneManager initialized')\r\n      }\r\n    }\r\n\r\n    // Getters\r\n\r\n    get wrapper() {\r\n      if (!this._wrapper) {\r\n        this._wrapper = $(Selector.WRAPPER)\r\n\r\n        if (this._wrapper.length === 0) {\r\n          this._wrapper = $('<div class=\"pane-wrapper\"></div>')\r\n          $(this._config.container).append(this._wrapper)\r\n        }\r\n      }\r\n\r\n      return this._wrapper\r\n    }\r\n\r\n    // Public\r\n\r\n    refresh() {\r\n      this._wrapper.toggleClass('is-open', $(Selector.PANE, this._wrapper).length > 0)\r\n    }\r\n\r\n    config(key) {\r\n      if (!typeof this._config[key]) {\r\n        throw new TypeError('Undefined option name \"' + key + '\"')\r\n      }\r\n\r\n      return this._config[key]\r\n    }\r\n\r\n    // Private\r\n\r\n    _events() {\r\n      let manager = this\r\n\r\n      $(document)\r\n        .off(Event.CLICK_DATA_API, Selector.DATA_TOGGLE)\r\n        .on(Event.CLICK_DATA_API,\r\n            Selector.DATA_TOGGLE,\r\n            function (event) {\r\n              event.preventDefault()\r\n\r\n              // Debug\r\n              if (manager.config('debug')) {\r\n                console.debug('Selector', Selector.DATA_TOGGLE, 'has been clicked')\r\n              }\r\n\r\n              manager._pane(this)\r\n            })\r\n    }\r\n\r\n    _pane(relatedTarget) {\r\n      let pane = null,\r\n        href = $(relatedTarget).data('href') || $(relatedTarget).attr('href'),\r\n        target = $(relatedTarget).data('paneTarget') || ''\r\n\r\n      if (!href) {\r\n        console.error('Pane has no href to load content')\r\n        return\r\n      }\r\n\r\n      // Target self?\r\n      if (target === 'self') {\r\n        pane = $(this).parents(Selector.PANE).data('pane')\r\n      }\r\n\r\n      // Need to create pane?\r\n      if (!pane) {\r\n        pane = new Pane(this)\r\n        pane.open($(relatedTarget).data('paneClass') || '')\r\n      }\r\n      pane.load(href)\r\n\r\n      return pane\r\n    }\r\n\r\n    _getConfig(config) {\r\n      config = {\r\n        ...Default,\r\n        ...config\r\n      }\r\n\r\n      return config\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Pane\r\n   */\r\n  class Pane {\r\n    constructor(paneManager) {\r\n      this._manager = paneManager\r\n      this._jqXHR = null\r\n      this._isTransitioning = false\r\n      this._element = null\r\n      this._href = null\r\n\r\n      this._element = $('<div role=\"complementary\" class=\"pane\"></div>')\r\n      this._element.data('pane', this)\r\n      this._events()\r\n    }\r\n\r\n    // Public\r\n\r\n    open(className) {\r\n      if (this._isTransitioning) {\r\n        return\r\n      }\r\n\r\n      let pane = this\r\n\r\n      // Size?\r\n      if (typeof className === 'string') {\r\n        pane._element.addClass(className)\r\n      }\r\n\r\n      this._isTransitioning = true\r\n      this._manager.wrapper.prepend(this._element)\r\n      this._manager.refresh()\r\n\r\n      // Event trigger\r\n      pane._element.trigger(Event.SHOW)\r\n      if (pane._manager.config('debug')) {\r\n        console.debug('Triggered event:', Event.SHOW)\r\n      }\r\n\r\n      // Animation\r\n      setTimeout(\r\n        function () {\r\n          pane._element.addClass('is-visible')\r\n\r\n          // Event trigger\r\n          pane._element.trigger(Event.SHOWN)\r\n          if (pane._manager.config('debug')) {\r\n            console.debug('Triggered event:', Event.SHOWN)\r\n          }\r\n\r\n          pane._isTransitioning = false\r\n        },\r\n        50\r\n      )\r\n    }\r\n\r\n    reload() {\r\n      this.load(this._href)\r\n    }\r\n\r\n    load(href) {\r\n      if (typeof href !== 'string') {\r\n        throw new TypeError('Pane::load() method need href in first argument')\r\n      }\r\n\r\n      this._ajax({url: href})\r\n      this._href = href\r\n    }\r\n\r\n    close() {\r\n      if (this._isTransitioning) {\r\n        return\r\n      }\r\n\r\n      let pane = this,\r\n        manager = this._manager\r\n\r\n      // Event trigger\r\n      let eventClose = $.Event(Event.HIDE, {pane: pane._element})\r\n      pane._element.trigger(eventClose)\r\n      if (pane._manager.config('debug')) {\r\n        console.debug('Triggered event:', Event.HIDE)\r\n      }\r\n\r\n      if (!eventClose.isPropagationStopped()) {\r\n        // Animation\r\n        this._isTransitioning = true\r\n        pane._element.removeClass('is-visible')\r\n\r\n        // After animation\r\n        setTimeout(\r\n          function () {\r\n            pane._element.remove()\r\n            manager.refresh()\r\n\r\n            // Event trigger\r\n            pane._element.trigger(Event.HIDDEN)\r\n            if (pane._manager.config('debug')) {\r\n              console.debug('Triggered event:', Event.HIDDEN)\r\n            }\r\n\r\n            pane._isTransitioning = false\r\n          },\r\n          400\r\n        )\r\n      }\r\n    }\r\n\r\n    // Private\r\n\r\n    _events() {\r\n      let pane = this\r\n\r\n      this._element\r\n          // Dismiss\r\n          .off(Event.CLICK_DISMISS, Selector.DATA_DISMISS)\r\n          .on(Event.CLICK_DISMISS,\r\n              Selector.DATA_DISMISS,\r\n              function (event) {\r\n                event.preventDefault()\r\n\r\n                pane.close()\r\n              })\r\n          // Submit buttons\r\n          .off(Event.CLICK_DATA_API, Selector.SUBMIT)\r\n          .on(Event.CLICK_DATA_API,\r\n              Selector.SUBMIT,\r\n              function () {\r\n                let $form = $(this).parents('form')\r\n\r\n                $form.data('submitButton', {'name': $(this).attr('name'), 'value': $(this).val()})\r\n              })\r\n          // Submit form\r\n          .off(Event.SUBMIT_DATA_API, Selector.FORM)\r\n          .on(Event.SUBMIT_DATA_API,\r\n              Selector.FORM,\r\n              function (event) {\r\n                event.preventDefault()\r\n\r\n                let $form = $(this)\r\n\r\n                if (typeof $form.get(0).checkValidity !== 'function' || $form.get(0).checkValidity()) {\r\n                  // Get data of form\r\n                  let formData = $form.serializeArray()\r\n\r\n                  // Add button\r\n                  if ($.isPlainObject($form.data('submitButton'))) {\r\n                    formData.push($form.data('submitButton'))\r\n                  }\r\n\r\n                  // Form submission\r\n                  pane._ajax({\r\n                               url: $(this).attr('action') || pane._href,\r\n                               method: $(this).attr('method') || 'get',\r\n                               data: formData,\r\n                               dataType: 'json'\r\n                             })\r\n\r\n                  // Remove submit button reference\r\n                  $form.removeData('submitButton')\r\n                }\r\n              })\r\n    }\r\n\r\n    _loader(toggle) {\r\n      toggle = typeof toggle === 'boolean' ? toggle : true\r\n\r\n      if (toggle) {\r\n        let $loader = $(Selector.LOADER, this._element)\r\n\r\n        if ($loader.length === 0) {\r\n          $loader = $('<div class=\"pane-loader\"></div>')\r\n          $loader.append(this._manager.config('loader'))\r\n          $(this._element).prepend($loader)\r\n        }\r\n      } else {\r\n        $(Selector.LOADER, this._element).remove()\r\n      }\r\n    }\r\n\r\n    _ajax(options) {\r\n      if (this._jqXHR) {\r\n        return\r\n      }\r\n\r\n      let pane = this\r\n\r\n      // Event trigger\r\n      pane._element.trigger(Event.LOADING)\r\n      if (pane._manager.config('debug')) {\r\n        console.debug('Triggered event:', Event.LOADING)\r\n      }\r\n      pane._loader(true)\r\n\r\n      // Ajax options\r\n      options = {\r\n        method: 'get',\r\n        ...this._manager.config('ajax'),\r\n        ...options,\r\n        success: function (data, textStatus, jqXHR) {\r\n          let eventLoaded = $.Event(Event.LOADED,\r\n                                    {\r\n                                      pane: pane._element,\r\n                                      paneAjax: {\r\n                                        data: data,\r\n                                        textStatus: textStatus,\r\n                                        jqXHR: jqXHR,\r\n                                      }\r\n                                    })\r\n\r\n          // Event trigger\r\n          pane._element.trigger(eventLoaded)\r\n          if (pane._manager.config('debug')) {\r\n            console.debug('Triggered event:', Event.LOADED)\r\n          }\r\n\r\n          if (!eventLoaded.isPropagationStopped()) {\r\n            pane._element.html(jqXHR.responseText)\r\n            pane._element.trigger(Event.PRINTED, pane._element)\r\n            if (pane._manager.config('debug')) {\r\n              console.debug('Triggered event:', Event.PRINTED)\r\n            }\r\n          }\r\n        },\r\n        error: function (jqXHR, textStatus, errorThrown) {\r\n          let eventLoadingError = $.Event(Event.LOADING_ERROR,\r\n                                          {\r\n                                            pane: pane._element,\r\n                                            paneAjax: {\r\n                                              textStatus: textStatus,\r\n                                              jqXHR: jqXHR,\r\n                                              errorThrown: errorThrown,\r\n                                            }\r\n                                          })\r\n          // Event trigger\r\n          pane._element.trigger(eventLoadingError)\r\n          if (pane._manager.config('debug')) {\r\n            console.debug('Triggered event:', Event.LOADING_ERROR)\r\n          }\r\n\r\n          if (!eventLoadingError.isPropagationStopped()) {\r\n            pane.close()\r\n          }\r\n        },\r\n        complete: function () {\r\n          pane._jqXHR = null\r\n          pane._loader(false)\r\n        }\r\n      }\r\n\r\n      // Ajax\r\n      this._jqXHR = $.ajax(options)\r\n    }\r\n\r\n    static _jQueryInterface(action, arg1) {\r\n      return $.each(function () {\r\n        if (!(typeof $(this).data('pane') === 'object' && $(this).data('pane') instanceof Pane)) {\r\n          throw new Error('Not a pane')\r\n        }\r\n\r\n        if (typeof action === 'string') {\r\n          let pane = $(this).data('pane')\r\n\r\n          switch (action) {\r\n            case 'close':\r\n            case 'load':\r\n            case 'reload':\r\n              pane[action](arg1)\r\n              break\r\n            default:\r\n              throw new TypeError(`No method named \"${action}\"`)\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  // jQuery\r\n  $.fn['pane'] = Pane._jQueryInterface\r\n  $.fn['pane'].noConflict = function () {\r\n    return Pane._jQueryInterface\r\n  }\r\n\r\n  return function (config) {\r\n    return new PaneManager(config)\r\n  }\r\n})($)\r\n\r\nexport default PaneManager"],"names":["PaneManager","$","TypeError","Default","debug","container","loader","transitionInTime","transitionOutTime","ajax","Event","SHOW","SHOWN","HIDE","HIDDEN","LOADING","LOADED","LOADING_ERROR","PRINTED","SUBMIT","CLICK_DISMISS","CLICK_DATA_API","SUBMIT_DATA_API","Selector","WRAPPER","LOADER","PANE","FORM","DATA_TOGGLE","DATA_DISMISS","config","_config","_getConfig","_wrapper","_events","console","toggleClass","length","key","manager","document","off","on","event","preventDefault","_pane","relatedTarget","pane","href","data","attr","target","error","parents","Pane","open","load","append","paneManager","_manager","_jqXHR","_isTransitioning","_element","_href","className","addClass","wrapper","prepend","refresh","trigger","setTimeout","_ajax","url","eventClose","isPropagationStopped","removeClass","remove","close","$form","val","get","checkValidity","formData","serializeArray","isPlainObject","push","method","dataType","removeData","toggle","$loader","options","_loader","success","textStatus","jqXHR","eventLoaded","paneAjax","html","responseText","errorThrown","eventLoadingError","complete","action","arg1","each","Error","fn","_jQueryInterface","noConflict"],"mappings":"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"}