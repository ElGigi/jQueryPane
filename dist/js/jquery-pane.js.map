{"version":3,"file":"jquery-pane.js","sources":["../../src/js/Pane.js"],"sourcesContent":["/*\n * This file is part of jQuery Pane.\n *\n * @license   https://opensource.org/licenses/MIT MIT License\n * @copyright 2018\n * @author Cassie ROUSSEAU <https://github.com/K6-front>\n * @author Ronan GIRON <https://github.com/ElGigi>\n * @author Yohann LORANT <https://github.com/ylorant>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code, to the root.\n */\n\nimport $ from 'jquery'\n\nconst PaneManager = (($) => {\n  // Check jQuery requirements\n  if (typeof $ === 'undefined') {\n    throw new TypeError('jQuery Pane requires jQuery. jQuery must be included before.')\n  }\n\n  /**\n   * Defaults\n   */\n\n  const Default = {\n    debug: false,\n    container: 'body',\n    loader: '',\n    transitionInTime: 50,\n    transitionOutTime: 400,\n    ajax: {},\n  }\n\n  /**\n   * Events\n   */\n\n  const Event = {\n    // Pane\n    SHOW: 'show.pane',\n    SHOWN: 'shown.pane',\n    HIDE: 'hide.pane',\n    HIDDEN: 'hidden.pane',\n    // Pane content\n    LOADING: 'loading.content.pane',\n    LOADED: 'loaded.content.pane',\n    LOADING_ERROR: 'error.content.pane',\n    PRINTED: 'printed.content.pane',\n    SUBMIT: 'submit.content.pane',\n    // Selectors\n    CLICK_DISMISS: 'click.dismiss.pane',\n    CLICK_DATA_API: 'click.pane',\n    SUBMIT_DATA_API: 'submit.pane',\n  }\n\n  /**\n   * SELECTORS\n   */\n\n  const Selector = {\n    WRAPPER: '.pane-wrapper:first',\n    LOADER: '.pane-loader',\n    PANE: '.pane',\n    FORM: 'form:not([target])',\n    SUBMIT: 'form:not([target]) :submit[name]',\n    DATA_TOGGLE: '[data-toggle=\"pane\"]',\n    DATA_DISMISS: '[data-dismiss=\"pane\"]',\n  }\n\n  /**\n   * PaneManager\n   */\n  class PaneManager {\n    constructor(config) {\n      this._config = this._getConfig(config)\n      this._wrapper = null\n      this._events()\n\n      // Debug\n      if (this.config('debug')) {\n        console.debug('PaneManager initialized')\n      }\n    }\n\n    // Getters\n\n    get wrapper() {\n      if (!this._wrapper) {\n        this._wrapper = $(Selector.WRAPPER)\n\n        if (this._wrapper.length === 0) {\n          this._wrapper = $('<div class=\"pane-wrapper\"></div>')\n          $(this._config.container).append(this._wrapper)\n        }\n      }\n\n      return this._wrapper\n    }\n\n    // Public\n\n    refresh() {\n      this._wrapper.toggleClass('is-open', $(Selector.PANE, this._wrapper).length > 0)\n    }\n\n    config(key) {\n      if (!typeof this._config[key]) {\n        throw new TypeError('Undefined option name \"' + key + '\"')\n      }\n\n      return this._config[key]\n    }\n\n    // Private\n\n    _events() {\n      let manager = this\n\n      $(document)\n        .off(Event.CLICK_DATA_API, Selector.DATA_TOGGLE)\n        .on(Event.CLICK_DATA_API,\n            Selector.DATA_TOGGLE,\n            function (event) {\n              event.preventDefault()\n\n              // Debug\n              if (manager.config('debug')) {\n                console.debug('Selector', Selector.DATA_TOGGLE, 'has been clicked')\n              }\n\n              manager._pane(this)\n            })\n    }\n\n    _pane(relatedTarget) {\n      let pane = null,\n        href = $(relatedTarget).data('href') || $(relatedTarget).attr('href'),\n        target = $(relatedTarget).data('paneTarget') || ''\n\n      if (!href) {\n        console.error('Pane has no href to load content')\n        return\n      }\n\n      // Target self?\n      if (target === 'self') {\n        pane = $(relatedTarget).parents(Selector.PANE).data('pane')\n      }\n\n      // Need to create pane?\n      if (!pane) {\n        pane = new Pane(this)\n        pane.open($(relatedTarget).data('paneClass') || '')\n      }\n      pane.load(href)\n\n      return pane\n    }\n\n    _getConfig(config) {\n      config = {\n        ...Default,\n        ...config\n      }\n\n      return config\n    }\n  }\n\n  /**\n   * Pane\n   */\n  class Pane {\n    constructor(paneManager) {\n      this._manager = paneManager\n      this._jqXHR = null\n      this._isTransitioning = false\n      this._element = null\n      this._href = null\n\n      this._element = $('<div role=\"complementary\" class=\"pane\"></div>')\n      this._element.data('pane', this)\n      this._events()\n    }\n\n    // Public\n\n    open(className) {\n      if (this._isTransitioning) {\n        return\n      }\n\n      let pane = this\n\n      // Size?\n      if (typeof className === 'string') {\n        pane._element.addClass(className)\n      }\n\n      this._isTransitioning = true\n      this._manager.wrapper.prepend(this._element)\n      this._manager.refresh()\n\n      // Event trigger\n      pane._element.trigger(Event.SHOW)\n      if (pane._manager.config('debug')) {\n        console.debug('Triggered event:', Event.SHOW)\n      }\n\n      // Animation\n      setTimeout(\n        function () {\n          pane._element.addClass('is-visible')\n\n          // Event trigger\n          pane._element.trigger(Event.SHOWN)\n          if (pane._manager.config('debug')) {\n            console.debug('Triggered event:', Event.SHOWN)\n          }\n\n          pane._isTransitioning = false\n        },\n        50\n      )\n    }\n\n    reload() {\n      this.load(this._href)\n    }\n\n    load(href) {\n      if (typeof href !== 'string') {\n        throw new TypeError('Pane::load() method need href in first argument')\n      }\n\n      this._ajax({url: href})\n      this._href = href\n    }\n\n    close() {\n      if (this._isTransitioning) {\n        return\n      }\n\n      let pane = this,\n        manager = this._manager\n\n      // Event trigger\n      let eventClose = $.Event(Event.HIDE, {pane: pane._element})\n      pane._element.trigger(eventClose)\n      if (pane._manager.config('debug')) {\n        console.debug('Triggered event:', Event.HIDE)\n      }\n\n      if (!eventClose.isPropagationStopped()) {\n        // Animation\n        this._isTransitioning = true\n        pane._element.removeClass('is-visible')\n\n        // After animation\n        setTimeout(\n          function () {\n            pane._element.remove()\n            manager.refresh()\n\n            // Event trigger\n            pane._element.trigger(Event.HIDDEN)\n            if (pane._manager.config('debug')) {\n              console.debug('Triggered event:', Event.HIDDEN)\n            }\n\n            pane._isTransitioning = false\n          },\n          400\n        )\n      }\n    }\n\n    // Private\n\n    _events() {\n      let pane = this\n\n      this._element\n          // Dismiss\n          .off(Event.CLICK_DISMISS, Selector.DATA_DISMISS)\n          .on(Event.CLICK_DISMISS,\n              Selector.DATA_DISMISS,\n              function (event) {\n                event.preventDefault()\n\n                pane.close()\n              })\n          // Submit buttons\n          .off(Event.CLICK_DATA_API, Selector.SUBMIT)\n          .on(Event.CLICK_DATA_API,\n              Selector.SUBMIT,\n              function () {\n                let $form = $(this).parents('form')\n\n                $form.data('submitButton', {'name': $(this).attr('name'), 'value': $(this).val()})\n              })\n          // Submit form\n          .off(Event.SUBMIT_DATA_API, Selector.FORM)\n          .on(Event.SUBMIT_DATA_API,\n              Selector.FORM,\n              function (event) {\n                event.preventDefault()\n\n                let $form = $(this)\n\n                if (typeof $form.get(0).checkValidity !== 'function' || $form.get(0).checkValidity()) {\n                  // Get data of form\n                  let formData = pane._serializeForm($form)\n\n                  // Add button\n                  if ($.isPlainObject($form.data('submitButton'))) {\n                    let submitButtonData = $form.data('submitButton');\n                    formData.append(submitButtonData.name, submitButtonData.value);\n                  }\n\n                  // Form submission\n                  pane._ajax({\n                               url: $(this).attr('action') || pane._href,\n                               method: $(this).attr('method') || 'get',\n                               processData: false,\n                               contentType: false,\n                               data: formData,\n                               dataType: 'json'\n                             })\n\n                  // Remove submit button reference\n                  $form.removeData('submitButton')\n                }\n              })\n    }\n\n    _serializeForm(form) {\n      var formData = new FormData(),\n          formParams = form.serializeArray()\n\n      $.each(form.find('input[type=\"file\"]'), function(i, tag) {\n        $.each($(tag)[0].files, function(i, file) {\n          formData.append(tag.name, file);\n        });\n      });\n\n      $.each(formParams, function(i, val) {\n        formData.append(val.name, val.value);\n      });\n\n      return formData;\n    }\n\n    _loader(toggle) {\n      toggle = typeof toggle === 'boolean' ? toggle : true\n\n      if (toggle) {\n        let $loader = $(Selector.LOADER, this._element)\n\n        if ($loader.length === 0) {\n          $loader = $('<div class=\"pane-loader\"></div>')\n          $loader.append(this._manager.config('loader'))\n          $(this._element).prepend($loader)\n        }\n      } else {\n        $(Selector.LOADER, this._element).remove()\n      }\n    }\n\n    _ajax(options) {\n      if (this._jqXHR) {\n        return\n      }\n\n      let pane = this\n\n      // Event trigger\n      pane._element.trigger(Event.LOADING)\n      if (pane._manager.config('debug')) {\n        console.debug('Triggered event:', Event.LOADING)\n      }\n      pane._loader(true)\n\n      // Ajax options\n      options = {\n        method: 'get',\n        ...this._manager.config('ajax'),\n        ...options,\n        success: function (data, textStatus, jqXHR) {\n          pane._jqXHR = null\n          pane._loader(false)\n\n          let eventLoaded = $.Event(Event.LOADED,\n                                    {\n                                      pane: pane._element,\n                                      paneAjax: {\n                                        data: data,\n                                        textStatus: textStatus,\n                                        jqXHR: jqXHR,\n                                      }\n                                    })\n\n          // Event trigger\n          pane._element.trigger(eventLoaded)\n          if (pane._manager.config('debug')) {\n            console.debug('Triggered event:', Event.LOADED)\n          }\n\n          if (!eventLoaded.isPropagationStopped()) {\n            pane._element.html(jqXHR.responseText)\n            pane._element.trigger(Event.PRINTED, pane._element)\n            if (pane._manager.config('debug')) {\n              console.debug('Triggered event:', Event.PRINTED)\n            }\n          }\n        },\n        error: function (jqXHR, textStatus, errorThrown) {\n          pane._jqXHR = null\n          pane._loader(false)\n\n          let eventLoadingError = $.Event(Event.LOADING_ERROR,\n                                          {\n                                            pane: pane._element,\n                                            paneAjax: {\n                                              textStatus: textStatus,\n                                              jqXHR: jqXHR,\n                                              errorThrown: errorThrown,\n                                            }\n                                          })\n          // Event trigger\n          pane._element.trigger(eventLoadingError)\n          if (pane._manager.config('debug')) {\n            console.debug('Triggered event:', Event.LOADING_ERROR)\n          }\n\n          if (!eventLoadingError.isPropagationStopped()) {\n            pane.close()\n          }\n        }\n      }\n\n      // Ajax\n      this._jqXHR = $.ajax(options)\n    }\n\n    static _jQueryInterface(action, arg1) {\n      return this.each(function () {\n        if (!(typeof $(this).data('pane') === 'object' && $(this).data('pane') instanceof Pane)) {\n          throw new Error('Not a pane')\n        }\n\n        if (typeof action === 'string') {\n          let pane = $(this).data('pane')\n\n          switch (action) {\n            case 'close':\n            case 'load':\n            case 'reload':\n              pane[action](arg1)\n              break\n            default:\n              throw new TypeError(`No method named \"${action}\"`)\n          }\n        }\n      })\n    }\n  }\n\n  // jQuery\n  $.fn['pane'] = Pane._jQueryInterface\n  $.fn['pane'].noConflict = function () {\n    return Pane._jQueryInterface\n  }\n\n  return function (config) {\n    return new PaneManager(config)\n  }\n})($)\n\nexport default PaneManager"],"names":["PaneManager","$","TypeError","Default","debug","container","loader","transitionInTime","transitionOutTime","ajax","Event","SHOW","SHOWN","HIDE","HIDDEN","LOADING","LOADED","LOADING_ERROR","PRINTED","SUBMIT","CLICK_DISMISS","CLICK_DATA_API","SUBMIT_DATA_API","Selector","WRAPPER","LOADER","PANE","FORM","DATA_TOGGLE","DATA_DISMISS","config","_config","_getConfig","_wrapper","_events","console","toggleClass","length","key","manager","document","off","on","event","preventDefault","_pane","relatedTarget","pane","href","data","attr","target","error","parents","Pane","open","load","append","paneManager","_manager","_jqXHR","_isTransitioning","_element","_href","className","addClass","wrapper","prepend","refresh","trigger","setTimeout","_ajax","url","eventClose","isPropagationStopped","removeClass","remove","close","$form","val","get","checkValidity","formData","_serializeForm","isPlainObject","submitButtonData","name","value","method","processData","contentType","dataType","removeData","form","FormData","formParams","serializeArray","each","find","i","tag","files","file","toggle","$loader","options","_loader","success","textStatus","jqXHR","eventLoaded","paneAjax","html","responseText","errorThrown","eventLoadingError","action","arg1","Error","fn","_jQueryInterface","noConflict"],"mappings":"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"}